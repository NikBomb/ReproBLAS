#include <float.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "../config.h"
#include "../Common/Common.h"
#include <immintrin.h>
#include <emmintrin.h>

/*[[[cog
import cog
import generate
import dataTypes
import sumI2
]]]*/
//[[[end]]]

void dsumI2(int n, double* v, int incv, int fold, double* sum){
  /*[[[cog
  cog.out(generate.generate(sumI2.SumI2(dataTypes.Double), cog.inFile, args, params, mode))
  ]]]*/
  #ifdef __AVX__
    __m256d mask_BLP; AVX_BLP_MASKD(mask_BLP);
    double tmp_cons[4] __attribute__((aligned(32)));
    SET_DAZ_FLAG;
    switch(fold){
      case 3:{
        int i;

        __m256d v_0, v_1;
        __m256d q_0, q_1;
        __m256d s_0_0, s_0_1;
        __m256d s_1_0, s_1_1;
        __m256d s_2_0, s_2_1;

        s_0_0 = s_0_1 = _mm256_broadcast_sd(sum);
        s_1_0 = s_1_1 = _mm256_broadcast_sd(sum + 1);
        s_2_0 = s_2_1 = _mm256_broadcast_sd(sum + 2);
        if(incv == 1){

          for(i = 0; i + 8 <= n; i += 8, v += 8){
            v_0 = _mm256_loadu_pd(v);
            v_1 = _mm256_loadu_pd(v + 4);
            q_0 = s_0_0;
            q_1 = s_0_1;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            s_0_1 = _mm256_add_pd(s_0_1, _mm256_or_pd(v_1, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            q_1 = _mm256_sub_pd(q_1, s_0_1);
            v_0 = _mm256_add_pd(v_0, q_0);
            v_1 = _mm256_add_pd(v_1, q_1);
            q_0 = s_1_0;
            q_1 = s_1_1;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            s_1_1 = _mm256_add_pd(s_1_1, _mm256_or_pd(v_1, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            q_1 = _mm256_sub_pd(q_1, s_1_1);
            v_0 = _mm256_add_pd(v_0, q_0);
            v_1 = _mm256_add_pd(v_1, q_1);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
            s_2_1 = _mm256_add_pd(s_2_1, _mm256_or_pd(v_1, mask_BLP));
          }
          if(i + 4 <= n){
            v_0 = _mm256_loadu_pd(v);
            q_0 = s_0_0;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
            i += 4, v += 4;
          }
          if(i < n){
            v_0 = _mm256_set_pd(0, (n - i)>2?v[2]:0, (n - i)>1?v[1]:0, v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
          }
        }else{

          for(i = 0; i + 8 <= n; i += 8, v += (incv * 8)){
            v_0 = _mm256_set_pd(v[(incv * 3)], v[(incv * 2)], v[incv], v[0]);
            v_1 = _mm256_set_pd(v[(incv * 7)], v[(incv * 6)], v[(incv * 5)], v[(incv * 4)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            s_0_1 = _mm256_add_pd(s_0_1, _mm256_or_pd(v_1, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            q_1 = _mm256_sub_pd(q_1, s_0_1);
            v_0 = _mm256_add_pd(v_0, q_0);
            v_1 = _mm256_add_pd(v_1, q_1);
            q_0 = s_1_0;
            q_1 = s_1_1;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            s_1_1 = _mm256_add_pd(s_1_1, _mm256_or_pd(v_1, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            q_1 = _mm256_sub_pd(q_1, s_1_1);
            v_0 = _mm256_add_pd(v_0, q_0);
            v_1 = _mm256_add_pd(v_1, q_1);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
            s_2_1 = _mm256_add_pd(s_2_1, _mm256_or_pd(v_1, mask_BLP));
          }
          if(i + 4 <= n){
            v_0 = _mm256_set_pd(v[(incv * 3)], v[(incv * 2)], v[incv], v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
            i += 4, v += (incv * 4);
          }
          if(i < n){
            v_0 = _mm256_set_pd(0, (n - i)>2?v[(incv * 2)]:0, (n - i)>1?v[incv]:0, v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm256_add_pd(s_0_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_0_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm256_add_pd(s_1_0, _mm256_or_pd(v_0, mask_BLP));
            q_0 = _mm256_sub_pd(q_0, s_1_0);
            v_0 = _mm256_add_pd(v_0, q_0);
            s_2_0 = _mm256_add_pd(s_2_0, _mm256_or_pd(v_0, mask_BLP));
          }
        }
        s_0_0 = _mm256_sub_pd(s_0_0, _mm256_set_pd(sum[0], sum[0], sum[0], 0));
        q_0 = _mm256_broadcast_sd(sum);
        s_0_0 = _mm256_add_pd(s_0_0, _mm256_sub_pd(s_0_1, q_0));
        _mm256_store_pd(tmp_cons, s_0_0);
        sum[0] = tmp_cons[0] + tmp_cons[1] + tmp_cons[2] + tmp_cons[3];
        s_1_0 = _mm256_sub_pd(s_1_0, _mm256_set_pd(sum[1], sum[1], sum[1], 0));
        q_0 = _mm256_broadcast_sd(sum + 1);
        s_1_0 = _mm256_add_pd(s_1_0, _mm256_sub_pd(s_1_1, q_0));
        _mm256_store_pd(tmp_cons, s_1_0);
        sum[1] = tmp_cons[0] + tmp_cons[1] + tmp_cons[2] + tmp_cons[3];
        s_2_0 = _mm256_sub_pd(s_2_0, _mm256_set_pd(sum[2], sum[2], sum[2], 0));
        q_0 = _mm256_broadcast_sd(sum + 2);
        s_2_0 = _mm256_add_pd(s_2_0, _mm256_sub_pd(s_2_1, q_0));
        _mm256_store_pd(tmp_cons, s_2_0);
        sum[2] = tmp_cons[0] + tmp_cons[1] + tmp_cons[2] + tmp_cons[3];
        RESET_DAZ_FLAG
        return;
      }
      default:{
        int i, j;

        __m256d v_0;
        __m256d q_0;
        __m256d s_0;
        __m256d s_buffer[MAX_FOLD];

        for(j = 0; j < fold; j += 1){
          s_buffer[j] = _mm256_broadcast_sd(sum + j);
        }
        if(incv == 1){

          for(i = 0; i + 4 <= n; i += 4, v += 4){
            v_0 = _mm256_loadu_pd(v);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm256_add_pd(s_0, _mm256_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm256_sub_pd(s_0, q_0);
              v_0 = _mm256_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm256_add_pd(s_buffer[j], _mm256_or_pd(v_0, mask_BLP));
          }
          if(i < n){
            v_0 = _mm256_set_pd(0, (n - i)>2?v[2]:0, (n - i)>1?v[1]:0, v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm256_add_pd(s_0, _mm256_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm256_sub_pd(s_0, q_0);
              v_0 = _mm256_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm256_add_pd(s_buffer[j], _mm256_or_pd(v_0, mask_BLP));
          }
        }else{

          for(i = 0; i + 4 <= n; i += 4, v += (incv * 4)){
            v_0 = _mm256_set_pd(v[(incv * 3)], v[(incv * 2)], v[incv], v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm256_add_pd(s_0, _mm256_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm256_sub_pd(s_0, q_0);
              v_0 = _mm256_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm256_add_pd(s_buffer[j], _mm256_or_pd(v_0, mask_BLP));
          }
          if(i < n){
            v_0 = _mm256_set_pd(0, (n - i)>2?v[(incv * 2)]:0, (n - i)>1?v[incv]:0, v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm256_add_pd(s_0, _mm256_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm256_sub_pd(s_0, q_0);
              v_0 = _mm256_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm256_add_pd(s_buffer[j], _mm256_or_pd(v_0, mask_BLP));
          }
        }
        for(j = 0; j < fold; j += 1){
          s_buffer[j] = _mm256_sub_pd(s_buffer[j], _mm256_set_pd(sum[j], sum[j], sum[j], 0));
          _mm256_store_pd(tmp_cons, s_buffer[j]);
          sum[j] = tmp_cons[0] + tmp_cons[1] + tmp_cons[2] + tmp_cons[3];
        }
        RESET_DAZ_FLAG
        return;
      }
    }
  #elif defined(__SSE2__)
    __m128d mask_BLP; SSE_BLP_MASKD(mask_BLP);
    double tmp_cons[2] __attribute__((aligned(16)));
    SET_DAZ_FLAG;
    switch(fold){
      case 3:{
        int i;

        __m128d v_0, v_1, v_2, v_3, v_4, v_5, v_6, v_7, v_8, v_9, v_10, v_11, v_12, v_13, v_14, v_15, v_16, v_17, v_18, v_19, v_20, v_21, v_22, v_23, v_24, v_25, v_26, v_27, v_28, v_29, v_30, v_31, v_32, v_33, v_34, v_35, v_36, v_37, v_38, v_39, v_40, v_41, v_42, v_43, v_44, v_45, v_46, v_47;
        __m128d q_0, q_1, q_2, q_3, q_4, q_5, q_6, q_7;
        __m128d s_0_0, s_0_1, s_0_2, s_0_3, s_0_4, s_0_5, s_0_6, s_0_7;
        __m128d s_1_0, s_1_1, s_1_2, s_1_3, s_1_4, s_1_5, s_1_6, s_1_7;
        __m128d s_2_0, s_2_1, s_2_2, s_2_3, s_2_4, s_2_5, s_2_6, s_2_7;

        s_0_0 = s_0_1 = s_0_2 = s_0_3 = s_0_4 = s_0_5 = s_0_6 = s_0_7 = _mm_load1_pd(sum);
        s_1_0 = s_1_1 = s_1_2 = s_1_3 = s_1_4 = s_1_5 = s_1_6 = s_1_7 = _mm_load1_pd(sum + 1);
        s_2_0 = s_2_1 = s_2_2 = s_2_3 = s_2_4 = s_2_5 = s_2_6 = s_2_7 = _mm_load1_pd(sum + 2);
        if(incv == 1){

          for(i = 0; i + 96 <= n; i += 96, v += 96){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            v_2 = _mm_loadu_pd(v + 4);
            v_3 = _mm_loadu_pd(v + 6);
            v_4 = _mm_loadu_pd(v + 8);
            v_5 = _mm_loadu_pd(v + 10);
            v_6 = _mm_loadu_pd(v + 12);
            v_7 = _mm_loadu_pd(v + 14);
            v_8 = _mm_loadu_pd(v + 16);
            v_9 = _mm_loadu_pd(v + 18);
            v_10 = _mm_loadu_pd(v + 20);
            v_11 = _mm_loadu_pd(v + 22);
            v_12 = _mm_loadu_pd(v + 24);
            v_13 = _mm_loadu_pd(v + 26);
            v_14 = _mm_loadu_pd(v + 28);
            v_15 = _mm_loadu_pd(v + 30);
            v_16 = _mm_loadu_pd(v + 32);
            v_17 = _mm_loadu_pd(v + 34);
            v_18 = _mm_loadu_pd(v + 36);
            v_19 = _mm_loadu_pd(v + 38);
            v_20 = _mm_loadu_pd(v + 40);
            v_21 = _mm_loadu_pd(v + 42);
            v_22 = _mm_loadu_pd(v + 44);
            v_23 = _mm_loadu_pd(v + 46);
            v_24 = _mm_loadu_pd(v + 48);
            v_25 = _mm_loadu_pd(v + 50);
            v_26 = _mm_loadu_pd(v + 52);
            v_27 = _mm_loadu_pd(v + 54);
            v_28 = _mm_loadu_pd(v + 56);
            v_29 = _mm_loadu_pd(v + 58);
            v_30 = _mm_loadu_pd(v + 60);
            v_31 = _mm_loadu_pd(v + 62);
            v_32 = _mm_loadu_pd(v + 64);
            v_33 = _mm_loadu_pd(v + 66);
            v_34 = _mm_loadu_pd(v + 68);
            v_35 = _mm_loadu_pd(v + 70);
            v_36 = _mm_loadu_pd(v + 72);
            v_37 = _mm_loadu_pd(v + 74);
            v_38 = _mm_loadu_pd(v + 76);
            v_39 = _mm_loadu_pd(v + 78);
            v_40 = _mm_loadu_pd(v + 80);
            v_41 = _mm_loadu_pd(v + 82);
            v_42 = _mm_loadu_pd(v + 84);
            v_43 = _mm_loadu_pd(v + 86);
            v_44 = _mm_loadu_pd(v + 88);
            v_45 = _mm_loadu_pd(v + 90);
            v_46 = _mm_loadu_pd(v + 92);
            v_47 = _mm_loadu_pd(v + 94);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_16, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_17, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_18, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_19, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_20, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_21, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_22, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_16, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_17, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_18, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_19, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_20, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_21, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_22, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_16, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_17, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_18, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_19, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_20, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_21, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_22, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_24, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_25, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_26, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_27, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_28, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_29, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_30, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_24, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_25, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_26, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_27, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_28, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_29, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_30, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_24, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_25, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_26, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_27, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_28, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_29, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_30, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_32, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_33, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_34, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_35, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_36, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_37, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_38, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_32 = _mm_add_pd(v_32, q_0);
            v_33 = _mm_add_pd(v_33, q_1);
            v_34 = _mm_add_pd(v_34, q_2);
            v_35 = _mm_add_pd(v_35, q_3);
            v_36 = _mm_add_pd(v_36, q_4);
            v_37 = _mm_add_pd(v_37, q_5);
            v_38 = _mm_add_pd(v_38, q_6);
            v_39 = _mm_add_pd(v_39, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_32, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_33, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_34, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_35, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_36, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_37, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_38, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_32 = _mm_add_pd(v_32, q_0);
            v_33 = _mm_add_pd(v_33, q_1);
            v_34 = _mm_add_pd(v_34, q_2);
            v_35 = _mm_add_pd(v_35, q_3);
            v_36 = _mm_add_pd(v_36, q_4);
            v_37 = _mm_add_pd(v_37, q_5);
            v_38 = _mm_add_pd(v_38, q_6);
            v_39 = _mm_add_pd(v_39, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_32, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_33, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_34, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_35, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_36, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_37, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_38, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_40, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_41, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_42, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_43, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_44, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_45, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_46, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_47, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_40 = _mm_add_pd(v_40, q_0);
            v_41 = _mm_add_pd(v_41, q_1);
            v_42 = _mm_add_pd(v_42, q_2);
            v_43 = _mm_add_pd(v_43, q_3);
            v_44 = _mm_add_pd(v_44, q_4);
            v_45 = _mm_add_pd(v_45, q_5);
            v_46 = _mm_add_pd(v_46, q_6);
            v_47 = _mm_add_pd(v_47, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_40, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_41, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_42, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_43, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_44, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_45, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_46, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_47, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_40 = _mm_add_pd(v_40, q_0);
            v_41 = _mm_add_pd(v_41, q_1);
            v_42 = _mm_add_pd(v_42, q_2);
            v_43 = _mm_add_pd(v_43, q_3);
            v_44 = _mm_add_pd(v_44, q_4);
            v_45 = _mm_add_pd(v_45, q_5);
            v_46 = _mm_add_pd(v_46, q_6);
            v_47 = _mm_add_pd(v_47, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_40, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_41, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_42, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_43, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_44, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_45, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_46, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_47, mask_BLP));
          }
          if(i + 64 <= n){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            v_2 = _mm_loadu_pd(v + 4);
            v_3 = _mm_loadu_pd(v + 6);
            v_4 = _mm_loadu_pd(v + 8);
            v_5 = _mm_loadu_pd(v + 10);
            v_6 = _mm_loadu_pd(v + 12);
            v_7 = _mm_loadu_pd(v + 14);
            v_8 = _mm_loadu_pd(v + 16);
            v_9 = _mm_loadu_pd(v + 18);
            v_10 = _mm_loadu_pd(v + 20);
            v_11 = _mm_loadu_pd(v + 22);
            v_12 = _mm_loadu_pd(v + 24);
            v_13 = _mm_loadu_pd(v + 26);
            v_14 = _mm_loadu_pd(v + 28);
            v_15 = _mm_loadu_pd(v + 30);
            v_16 = _mm_loadu_pd(v + 32);
            v_17 = _mm_loadu_pd(v + 34);
            v_18 = _mm_loadu_pd(v + 36);
            v_19 = _mm_loadu_pd(v + 38);
            v_20 = _mm_loadu_pd(v + 40);
            v_21 = _mm_loadu_pd(v + 42);
            v_22 = _mm_loadu_pd(v + 44);
            v_23 = _mm_loadu_pd(v + 46);
            v_24 = _mm_loadu_pd(v + 48);
            v_25 = _mm_loadu_pd(v + 50);
            v_26 = _mm_loadu_pd(v + 52);
            v_27 = _mm_loadu_pd(v + 54);
            v_28 = _mm_loadu_pd(v + 56);
            v_29 = _mm_loadu_pd(v + 58);
            v_30 = _mm_loadu_pd(v + 60);
            v_31 = _mm_loadu_pd(v + 62);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_16, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_17, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_18, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_19, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_20, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_21, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_22, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_16, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_17, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_18, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_19, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_20, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_21, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_22, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_16, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_17, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_18, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_19, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_20, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_21, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_22, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_24, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_25, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_26, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_27, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_28, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_29, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_30, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_24, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_25, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_26, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_27, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_28, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_29, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_30, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_24, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_25, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_26, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_27, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_28, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_29, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_30, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_31, mask_BLP));
            i += 64, v += 64;
          }
          if(i + 32 <= n){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            v_2 = _mm_loadu_pd(v + 4);
            v_3 = _mm_loadu_pd(v + 6);
            v_4 = _mm_loadu_pd(v + 8);
            v_5 = _mm_loadu_pd(v + 10);
            v_6 = _mm_loadu_pd(v + 12);
            v_7 = _mm_loadu_pd(v + 14);
            v_8 = _mm_loadu_pd(v + 16);
            v_9 = _mm_loadu_pd(v + 18);
            v_10 = _mm_loadu_pd(v + 20);
            v_11 = _mm_loadu_pd(v + 22);
            v_12 = _mm_loadu_pd(v + 24);
            v_13 = _mm_loadu_pd(v + 26);
            v_14 = _mm_loadu_pd(v + 28);
            v_15 = _mm_loadu_pd(v + 30);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            i += 32, v += 32;
          }
          if(i + 16 <= n){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            v_2 = _mm_loadu_pd(v + 4);
            v_3 = _mm_loadu_pd(v + 6);
            v_4 = _mm_loadu_pd(v + 8);
            v_5 = _mm_loadu_pd(v + 10);
            v_6 = _mm_loadu_pd(v + 12);
            v_7 = _mm_loadu_pd(v + 14);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            i += 16, v += 16;
          }
          if(i + 8 <= n){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            v_2 = _mm_loadu_pd(v + 4);
            v_3 = _mm_loadu_pd(v + 6);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            i += 8, v += 8;
          }
          if(i + 4 <= n){
            v_0 = _mm_loadu_pd(v);
            v_1 = _mm_loadu_pd(v + 2);
            q_0 = s_0_0;
            q_1 = s_0_1;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            q_0 = s_1_0;
            q_1 = s_1_1;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            i += 4, v += 4;
          }
          if(i + 2 <= n){
            v_0 = _mm_loadu_pd(v);
            q_0 = s_0_0;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            v_0 = _mm_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            v_0 = _mm_add_pd(v_0, q_0);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            i += 2, v += 2;
          }
          if(i < n){
            v_0 = _mm_set_pd(0, v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            v_0 = _mm_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            v_0 = _mm_add_pd(v_0, q_0);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
          }
        }else{

          for(i = 0; i + 96 <= n; i += 96, v += (incv * 96)){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            v_2 = _mm_set_pd(v[(incv * 5)], v[(incv * 4)]);
            v_3 = _mm_set_pd(v[(incv * 7)], v[(incv * 6)]);
            v_4 = _mm_set_pd(v[(incv * 9)], v[(incv * 8)]);
            v_5 = _mm_set_pd(v[(incv * 11)], v[(incv * 10)]);
            v_6 = _mm_set_pd(v[(incv * 13)], v[(incv * 12)]);
            v_7 = _mm_set_pd(v[(incv * 15)], v[(incv * 14)]);
            v_8 = _mm_set_pd(v[(incv * 17)], v[(incv * 16)]);
            v_9 = _mm_set_pd(v[(incv * 19)], v[(incv * 18)]);
            v_10 = _mm_set_pd(v[(incv * 21)], v[(incv * 20)]);
            v_11 = _mm_set_pd(v[(incv * 23)], v[(incv * 22)]);
            v_12 = _mm_set_pd(v[(incv * 25)], v[(incv * 24)]);
            v_13 = _mm_set_pd(v[(incv * 27)], v[(incv * 26)]);
            v_14 = _mm_set_pd(v[(incv * 29)], v[(incv * 28)]);
            v_15 = _mm_set_pd(v[(incv * 31)], v[(incv * 30)]);
            v_16 = _mm_set_pd(v[(incv * 33)], v[(incv * 32)]);
            v_17 = _mm_set_pd(v[(incv * 35)], v[(incv * 34)]);
            v_18 = _mm_set_pd(v[(incv * 37)], v[(incv * 36)]);
            v_19 = _mm_set_pd(v[(incv * 39)], v[(incv * 38)]);
            v_20 = _mm_set_pd(v[(incv * 41)], v[(incv * 40)]);
            v_21 = _mm_set_pd(v[(incv * 43)], v[(incv * 42)]);
            v_22 = _mm_set_pd(v[(incv * 45)], v[(incv * 44)]);
            v_23 = _mm_set_pd(v[(incv * 47)], v[(incv * 46)]);
            v_24 = _mm_set_pd(v[(incv * 49)], v[(incv * 48)]);
            v_25 = _mm_set_pd(v[(incv * 51)], v[(incv * 50)]);
            v_26 = _mm_set_pd(v[(incv * 53)], v[(incv * 52)]);
            v_27 = _mm_set_pd(v[(incv * 55)], v[(incv * 54)]);
            v_28 = _mm_set_pd(v[(incv * 57)], v[(incv * 56)]);
            v_29 = _mm_set_pd(v[(incv * 59)], v[(incv * 58)]);
            v_30 = _mm_set_pd(v[(incv * 61)], v[(incv * 60)]);
            v_31 = _mm_set_pd(v[(incv * 63)], v[(incv * 62)]);
            v_32 = _mm_set_pd(v[(incv * 65)], v[(incv * 64)]);
            v_33 = _mm_set_pd(v[(incv * 67)], v[(incv * 66)]);
            v_34 = _mm_set_pd(v[(incv * 69)], v[(incv * 68)]);
            v_35 = _mm_set_pd(v[(incv * 71)], v[(incv * 70)]);
            v_36 = _mm_set_pd(v[(incv * 73)], v[(incv * 72)]);
            v_37 = _mm_set_pd(v[(incv * 75)], v[(incv * 74)]);
            v_38 = _mm_set_pd(v[(incv * 77)], v[(incv * 76)]);
            v_39 = _mm_set_pd(v[(incv * 79)], v[(incv * 78)]);
            v_40 = _mm_set_pd(v[(incv * 81)], v[(incv * 80)]);
            v_41 = _mm_set_pd(v[(incv * 83)], v[(incv * 82)]);
            v_42 = _mm_set_pd(v[(incv * 85)], v[(incv * 84)]);
            v_43 = _mm_set_pd(v[(incv * 87)], v[(incv * 86)]);
            v_44 = _mm_set_pd(v[(incv * 89)], v[(incv * 88)]);
            v_45 = _mm_set_pd(v[(incv * 91)], v[(incv * 90)]);
            v_46 = _mm_set_pd(v[(incv * 93)], v[(incv * 92)]);
            v_47 = _mm_set_pd(v[(incv * 95)], v[(incv * 94)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_16, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_17, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_18, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_19, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_20, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_21, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_22, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_16, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_17, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_18, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_19, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_20, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_21, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_22, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_16, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_17, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_18, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_19, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_20, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_21, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_22, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_24, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_25, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_26, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_27, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_28, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_29, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_30, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_24, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_25, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_26, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_27, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_28, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_29, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_30, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_24, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_25, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_26, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_27, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_28, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_29, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_30, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_32, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_33, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_34, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_35, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_36, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_37, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_38, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_32 = _mm_add_pd(v_32, q_0);
            v_33 = _mm_add_pd(v_33, q_1);
            v_34 = _mm_add_pd(v_34, q_2);
            v_35 = _mm_add_pd(v_35, q_3);
            v_36 = _mm_add_pd(v_36, q_4);
            v_37 = _mm_add_pd(v_37, q_5);
            v_38 = _mm_add_pd(v_38, q_6);
            v_39 = _mm_add_pd(v_39, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_32, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_33, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_34, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_35, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_36, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_37, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_38, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_32 = _mm_add_pd(v_32, q_0);
            v_33 = _mm_add_pd(v_33, q_1);
            v_34 = _mm_add_pd(v_34, q_2);
            v_35 = _mm_add_pd(v_35, q_3);
            v_36 = _mm_add_pd(v_36, q_4);
            v_37 = _mm_add_pd(v_37, q_5);
            v_38 = _mm_add_pd(v_38, q_6);
            v_39 = _mm_add_pd(v_39, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_32, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_33, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_34, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_35, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_36, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_37, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_38, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_39, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_40, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_41, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_42, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_43, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_44, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_45, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_46, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_47, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_40 = _mm_add_pd(v_40, q_0);
            v_41 = _mm_add_pd(v_41, q_1);
            v_42 = _mm_add_pd(v_42, q_2);
            v_43 = _mm_add_pd(v_43, q_3);
            v_44 = _mm_add_pd(v_44, q_4);
            v_45 = _mm_add_pd(v_45, q_5);
            v_46 = _mm_add_pd(v_46, q_6);
            v_47 = _mm_add_pd(v_47, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_40, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_41, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_42, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_43, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_44, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_45, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_46, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_47, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_40 = _mm_add_pd(v_40, q_0);
            v_41 = _mm_add_pd(v_41, q_1);
            v_42 = _mm_add_pd(v_42, q_2);
            v_43 = _mm_add_pd(v_43, q_3);
            v_44 = _mm_add_pd(v_44, q_4);
            v_45 = _mm_add_pd(v_45, q_5);
            v_46 = _mm_add_pd(v_46, q_6);
            v_47 = _mm_add_pd(v_47, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_40, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_41, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_42, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_43, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_44, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_45, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_46, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_47, mask_BLP));
          }
          if(i + 64 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            v_2 = _mm_set_pd(v[(incv * 5)], v[(incv * 4)]);
            v_3 = _mm_set_pd(v[(incv * 7)], v[(incv * 6)]);
            v_4 = _mm_set_pd(v[(incv * 9)], v[(incv * 8)]);
            v_5 = _mm_set_pd(v[(incv * 11)], v[(incv * 10)]);
            v_6 = _mm_set_pd(v[(incv * 13)], v[(incv * 12)]);
            v_7 = _mm_set_pd(v[(incv * 15)], v[(incv * 14)]);
            v_8 = _mm_set_pd(v[(incv * 17)], v[(incv * 16)]);
            v_9 = _mm_set_pd(v[(incv * 19)], v[(incv * 18)]);
            v_10 = _mm_set_pd(v[(incv * 21)], v[(incv * 20)]);
            v_11 = _mm_set_pd(v[(incv * 23)], v[(incv * 22)]);
            v_12 = _mm_set_pd(v[(incv * 25)], v[(incv * 24)]);
            v_13 = _mm_set_pd(v[(incv * 27)], v[(incv * 26)]);
            v_14 = _mm_set_pd(v[(incv * 29)], v[(incv * 28)]);
            v_15 = _mm_set_pd(v[(incv * 31)], v[(incv * 30)]);
            v_16 = _mm_set_pd(v[(incv * 33)], v[(incv * 32)]);
            v_17 = _mm_set_pd(v[(incv * 35)], v[(incv * 34)]);
            v_18 = _mm_set_pd(v[(incv * 37)], v[(incv * 36)]);
            v_19 = _mm_set_pd(v[(incv * 39)], v[(incv * 38)]);
            v_20 = _mm_set_pd(v[(incv * 41)], v[(incv * 40)]);
            v_21 = _mm_set_pd(v[(incv * 43)], v[(incv * 42)]);
            v_22 = _mm_set_pd(v[(incv * 45)], v[(incv * 44)]);
            v_23 = _mm_set_pd(v[(incv * 47)], v[(incv * 46)]);
            v_24 = _mm_set_pd(v[(incv * 49)], v[(incv * 48)]);
            v_25 = _mm_set_pd(v[(incv * 51)], v[(incv * 50)]);
            v_26 = _mm_set_pd(v[(incv * 53)], v[(incv * 52)]);
            v_27 = _mm_set_pd(v[(incv * 55)], v[(incv * 54)]);
            v_28 = _mm_set_pd(v[(incv * 57)], v[(incv * 56)]);
            v_29 = _mm_set_pd(v[(incv * 59)], v[(incv * 58)]);
            v_30 = _mm_set_pd(v[(incv * 61)], v[(incv * 60)]);
            v_31 = _mm_set_pd(v[(incv * 63)], v[(incv * 62)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_16, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_17, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_18, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_19, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_20, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_21, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_22, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_16, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_17, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_18, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_19, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_20, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_21, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_22, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_16 = _mm_add_pd(v_16, q_0);
            v_17 = _mm_add_pd(v_17, q_1);
            v_18 = _mm_add_pd(v_18, q_2);
            v_19 = _mm_add_pd(v_19, q_3);
            v_20 = _mm_add_pd(v_20, q_4);
            v_21 = _mm_add_pd(v_21, q_5);
            v_22 = _mm_add_pd(v_22, q_6);
            v_23 = _mm_add_pd(v_23, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_16, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_17, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_18, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_19, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_20, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_21, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_22, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_23, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_24, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_25, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_26, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_27, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_28, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_29, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_30, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_24, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_25, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_26, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_27, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_28, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_29, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_30, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_31, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_24 = _mm_add_pd(v_24, q_0);
            v_25 = _mm_add_pd(v_25, q_1);
            v_26 = _mm_add_pd(v_26, q_2);
            v_27 = _mm_add_pd(v_27, q_3);
            v_28 = _mm_add_pd(v_28, q_4);
            v_29 = _mm_add_pd(v_29, q_5);
            v_30 = _mm_add_pd(v_30, q_6);
            v_31 = _mm_add_pd(v_31, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_24, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_25, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_26, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_27, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_28, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_29, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_30, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_31, mask_BLP));
            i += 64, v += (incv * 64);
          }
          if(i + 32 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            v_2 = _mm_set_pd(v[(incv * 5)], v[(incv * 4)]);
            v_3 = _mm_set_pd(v[(incv * 7)], v[(incv * 6)]);
            v_4 = _mm_set_pd(v[(incv * 9)], v[(incv * 8)]);
            v_5 = _mm_set_pd(v[(incv * 11)], v[(incv * 10)]);
            v_6 = _mm_set_pd(v[(incv * 13)], v[(incv * 12)]);
            v_7 = _mm_set_pd(v[(incv * 15)], v[(incv * 14)]);
            v_8 = _mm_set_pd(v[(incv * 17)], v[(incv * 16)]);
            v_9 = _mm_set_pd(v[(incv * 19)], v[(incv * 18)]);
            v_10 = _mm_set_pd(v[(incv * 21)], v[(incv * 20)]);
            v_11 = _mm_set_pd(v[(incv * 23)], v[(incv * 22)]);
            v_12 = _mm_set_pd(v[(incv * 25)], v[(incv * 24)]);
            v_13 = _mm_set_pd(v[(incv * 27)], v[(incv * 26)]);
            v_14 = _mm_set_pd(v[(incv * 29)], v[(incv * 28)]);
            v_15 = _mm_set_pd(v[(incv * 31)], v[(incv * 30)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_8, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_9, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_10, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_11, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_12, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_13, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_14, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_8, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_9, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_10, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_11, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_12, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_13, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_14, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_15, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_8 = _mm_add_pd(v_8, q_0);
            v_9 = _mm_add_pd(v_9, q_1);
            v_10 = _mm_add_pd(v_10, q_2);
            v_11 = _mm_add_pd(v_11, q_3);
            v_12 = _mm_add_pd(v_12, q_4);
            v_13 = _mm_add_pd(v_13, q_5);
            v_14 = _mm_add_pd(v_14, q_6);
            v_15 = _mm_add_pd(v_15, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_8, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_9, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_10, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_11, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_12, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_13, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_14, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_15, mask_BLP));
            i += 32, v += (incv * 32);
          }
          if(i + 16 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            v_2 = _mm_set_pd(v[(incv * 5)], v[(incv * 4)]);
            v_3 = _mm_set_pd(v[(incv * 7)], v[(incv * 6)]);
            v_4 = _mm_set_pd(v[(incv * 9)], v[(incv * 8)]);
            v_5 = _mm_set_pd(v[(incv * 11)], v[(incv * 10)]);
            v_6 = _mm_set_pd(v[(incv * 13)], v[(incv * 12)]);
            v_7 = _mm_set_pd(v[(incv * 15)], v[(incv * 14)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            q_4 = s_0_4;
            q_5 = s_0_5;
            q_6 = s_0_6;
            q_7 = s_0_7;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            s_0_4 = _mm_add_pd(s_0_4, _mm_or_pd(v_4, mask_BLP));
            s_0_5 = _mm_add_pd(s_0_5, _mm_or_pd(v_5, mask_BLP));
            s_0_6 = _mm_add_pd(s_0_6, _mm_or_pd(v_6, mask_BLP));
            s_0_7 = _mm_add_pd(s_0_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            q_4 = _mm_sub_pd(q_4, s_0_4);
            q_5 = _mm_sub_pd(q_5, s_0_5);
            q_6 = _mm_sub_pd(q_6, s_0_6);
            q_7 = _mm_sub_pd(q_7, s_0_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            q_4 = s_1_4;
            q_5 = s_1_5;
            q_6 = s_1_6;
            q_7 = s_1_7;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            s_1_4 = _mm_add_pd(s_1_4, _mm_or_pd(v_4, mask_BLP));
            s_1_5 = _mm_add_pd(s_1_5, _mm_or_pd(v_5, mask_BLP));
            s_1_6 = _mm_add_pd(s_1_6, _mm_or_pd(v_6, mask_BLP));
            s_1_7 = _mm_add_pd(s_1_7, _mm_or_pd(v_7, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            q_4 = _mm_sub_pd(q_4, s_1_4);
            q_5 = _mm_sub_pd(q_5, s_1_5);
            q_6 = _mm_sub_pd(q_6, s_1_6);
            q_7 = _mm_sub_pd(q_7, s_1_7);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            v_4 = _mm_add_pd(v_4, q_4);
            v_5 = _mm_add_pd(v_5, q_5);
            v_6 = _mm_add_pd(v_6, q_6);
            v_7 = _mm_add_pd(v_7, q_7);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            s_2_4 = _mm_add_pd(s_2_4, _mm_or_pd(v_4, mask_BLP));
            s_2_5 = _mm_add_pd(s_2_5, _mm_or_pd(v_5, mask_BLP));
            s_2_6 = _mm_add_pd(s_2_6, _mm_or_pd(v_6, mask_BLP));
            s_2_7 = _mm_add_pd(s_2_7, _mm_or_pd(v_7, mask_BLP));
            i += 16, v += (incv * 16);
          }
          if(i + 8 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            v_2 = _mm_set_pd(v[(incv * 5)], v[(incv * 4)]);
            v_3 = _mm_set_pd(v[(incv * 7)], v[(incv * 6)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            q_2 = s_0_2;
            q_3 = s_0_3;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            s_0_2 = _mm_add_pd(s_0_2, _mm_or_pd(v_2, mask_BLP));
            s_0_3 = _mm_add_pd(s_0_3, _mm_or_pd(v_3, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            q_2 = _mm_sub_pd(q_2, s_0_2);
            q_3 = _mm_sub_pd(q_3, s_0_3);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            q_0 = s_1_0;
            q_1 = s_1_1;
            q_2 = s_1_2;
            q_3 = s_1_3;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            s_1_2 = _mm_add_pd(s_1_2, _mm_or_pd(v_2, mask_BLP));
            s_1_3 = _mm_add_pd(s_1_3, _mm_or_pd(v_3, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            q_2 = _mm_sub_pd(q_2, s_1_2);
            q_3 = _mm_sub_pd(q_3, s_1_3);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            v_2 = _mm_add_pd(v_2, q_2);
            v_3 = _mm_add_pd(v_3, q_3);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            s_2_2 = _mm_add_pd(s_2_2, _mm_or_pd(v_2, mask_BLP));
            s_2_3 = _mm_add_pd(s_2_3, _mm_or_pd(v_3, mask_BLP));
            i += 8, v += (incv * 8);
          }
          if(i + 4 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            v_1 = _mm_set_pd(v[(incv * 3)], v[(incv * 2)]);
            q_0 = s_0_0;
            q_1 = s_0_1;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            s_0_1 = _mm_add_pd(s_0_1, _mm_or_pd(v_1, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            q_1 = _mm_sub_pd(q_1, s_0_1);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            q_0 = s_1_0;
            q_1 = s_1_1;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            s_1_1 = _mm_add_pd(s_1_1, _mm_or_pd(v_1, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            q_1 = _mm_sub_pd(q_1, s_1_1);
            v_0 = _mm_add_pd(v_0, q_0);
            v_1 = _mm_add_pd(v_1, q_1);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            s_2_1 = _mm_add_pd(s_2_1, _mm_or_pd(v_1, mask_BLP));
            i += 4, v += (incv * 4);
          }
          if(i + 2 <= n){
            v_0 = _mm_set_pd(v[incv], v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            v_0 = _mm_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            v_0 = _mm_add_pd(v_0, q_0);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
            i += 2, v += (incv * 2);
          }
          if(i < n){
            v_0 = _mm_set_pd(0, v[0]);
            q_0 = s_0_0;
            s_0_0 = _mm_add_pd(s_0_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_0_0);
            v_0 = _mm_add_pd(v_0, q_0);
            q_0 = s_1_0;
            s_1_0 = _mm_add_pd(s_1_0, _mm_or_pd(v_0, mask_BLP));
            q_0 = _mm_sub_pd(q_0, s_1_0);
            v_0 = _mm_add_pd(v_0, q_0);
            s_2_0 = _mm_add_pd(s_2_0, _mm_or_pd(v_0, mask_BLP));
          }
        }
        s_0_0 = _mm_sub_pd(s_0_0, _mm_set_pd(sum[0], 0));
        q_0 = _mm_load1_pd(sum);
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_1, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_2, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_3, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_4, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_5, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_6, q_0));
        s_0_0 = _mm_add_pd(s_0_0, _mm_sub_pd(s_0_7, q_0));
        _mm_store_pd(tmp_cons, s_0_0);
        sum[0] = tmp_cons[0] + tmp_cons[1];
        s_1_0 = _mm_sub_pd(s_1_0, _mm_set_pd(sum[1], 0));
        q_0 = _mm_load1_pd(sum + 1);
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_1, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_2, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_3, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_4, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_5, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_6, q_0));
        s_1_0 = _mm_add_pd(s_1_0, _mm_sub_pd(s_1_7, q_0));
        _mm_store_pd(tmp_cons, s_1_0);
        sum[1] = tmp_cons[0] + tmp_cons[1];
        s_2_0 = _mm_sub_pd(s_2_0, _mm_set_pd(sum[2], 0));
        q_0 = _mm_load1_pd(sum + 2);
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_1, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_2, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_3, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_4, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_5, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_6, q_0));
        s_2_0 = _mm_add_pd(s_2_0, _mm_sub_pd(s_2_7, q_0));
        _mm_store_pd(tmp_cons, s_2_0);
        sum[2] = tmp_cons[0] + tmp_cons[1];
        RESET_DAZ_FLAG
        return;
      }
      default:{
        int i, j;

        __m128d v_0;
        __m128d q_0;
        __m128d s_0;
        __m128d s_buffer[MAX_FOLD];

        for(j = 0; j < fold; j += 1){
          s_buffer[j] = _mm_load1_pd(sum + j);
        }
        if(incv == 1){

          for(i = 0; i + 2 <= n; i += 2, v += 2){
            v_0 = _mm_loadu_pd(v);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm_add_pd(s_0, _mm_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm_sub_pd(s_0, q_0);
              v_0 = _mm_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm_add_pd(s_buffer[j], _mm_or_pd(v_0, mask_BLP));
          }
          if(i < n){
            v_0 = _mm_set_pd(0, v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm_add_pd(s_0, _mm_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm_sub_pd(s_0, q_0);
              v_0 = _mm_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm_add_pd(s_buffer[j], _mm_or_pd(v_0, mask_BLP));
          }
        }else{

          for(i = 0; i + 2 <= n; i += 2, v += (incv * 2)){
            v_0 = _mm_set_pd(v[incv], v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm_add_pd(s_0, _mm_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm_sub_pd(s_0, q_0);
              v_0 = _mm_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm_add_pd(s_buffer[j], _mm_or_pd(v_0, mask_BLP));
          }
          if(i < n){
            v_0 = _mm_set_pd(0, v[0]);
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              q_0 = _mm_add_pd(s_0, _mm_or_pd(v_0, mask_BLP));
              s_buffer[j] = q_0;
              q_0 = _mm_sub_pd(s_0, q_0);
              v_0 = _mm_add_pd(v_0, q_0);
            }
            s_buffer[j] = _mm_add_pd(s_buffer[j], _mm_or_pd(v_0, mask_BLP));
          }
        }
        for(j = 0; j < fold; j += 1){
          s_buffer[j] = _mm_sub_pd(s_buffer[j], _mm_set_pd(sum[j], 0));
          _mm_store_pd(tmp_cons, s_buffer[j]);
          sum[j] = tmp_cons[0] + tmp_cons[1];
        }
        RESET_DAZ_FLAG
        return;
      }
    }
  #else
    long_double tmp_BLP;
    SET_DAZ_FLAG;
    switch(fold){
      case 3:{
        int i;

        double v_0;
        double q_0;
        double s_0_0;
        double s_1_0;
        double s_2_0;

        s_0_0 = sum[0];
        s_1_0 = sum[1];
        s_2_0 = sum[2];
        if(incv == 1){

          for(i = 0; i + 1 <= n; i += 1, v += 1){
            v_0 = v[0];
            q_0 = s_0_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_0_0 = s_0_0 + tmp_BLP.d;
            q_0 = q_0 - s_0_0;
            v_0 = v_0 + q_0;
            q_0 = s_1_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_1_0 = s_1_0 + tmp_BLP.d;
            q_0 = q_0 - s_1_0;
            v_0 = v_0 + q_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_2_0 = s_2_0 + tmp_BLP.d;
          }
        }else{

          for(i = 0; i + 1 <= n; i += 1, v += incv){
            v_0 = v[0];
            q_0 = s_0_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_0_0 = s_0_0 + tmp_BLP.d;
            q_0 = q_0 - s_0_0;
            v_0 = v_0 + q_0;
            q_0 = s_1_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_1_0 = s_1_0 + tmp_BLP.d;
            q_0 = q_0 - s_1_0;
            v_0 = v_0 + q_0;
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_2_0 = s_2_0 + tmp_BLP.d;
          }
        }
        sum[0] = s_0_0;
        sum[1] = s_1_0;
        sum[2] = s_2_0;
        RESET_DAZ_FLAG
        return;
      }
      default:{
        int i, j;

        double v_0;
        double q_0;
        double s_0;
        double s_buffer[MAX_FOLD];

        for(j = 0; j < fold; j += 1){
          s_buffer[j] = sum[j];
        }
        if(incv == 1){

          for(i = 0; i + 1 <= n; i += 1, v += 1){
            v_0 = v[0];
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              tmp_BLP.d = v_0;
              tmp_BLP.l |= 1;
              q_0 = s_0 + tmp_BLP.d;
              s_buffer[j] = q_0;
              q_0 = s_0 - q_0;
              v_0 = v_0 + q_0;
            }
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_buffer[j] = s_buffer[j] + tmp_BLP.d;
          }
        }else{

          for(i = 0; i + 1 <= n; i += 1, v += incv){
            v_0 = v[0];
            for(j = 0; j < fold - 1; j++){
              s_0 = s_buffer[j];
              tmp_BLP.d = v_0;
              tmp_BLP.l |= 1;
              q_0 = s_0 + tmp_BLP.d;
              s_buffer[j] = q_0;
              q_0 = s_0 - q_0;
              v_0 = v_0 + q_0;
            }
            tmp_BLP.d = v_0;
            tmp_BLP.l |= 1;
            s_buffer[j] = s_buffer[j] + tmp_BLP.d;
          }
        }
        for(j = 0; j < fold; j += 1){
          sum[j] = s_buffer[j];
        }
        RESET_DAZ_FLAG
        return;
      }
    }
  #endif
  //[[[end]]]
}
