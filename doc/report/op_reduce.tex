\subsection{Reduce}
    \label{sec:primitiveops_reduce}
    An operation to produce the sum of two indexed types is necessary to
    perform a reduction. For completeness we include the algorithm here,
    although apart from the simplified renormalization algorithm, it is
    equivalent to Algorithm $7$ in \cite{repsum}.

    \begin{samepage}
    \begin{alg}
      Given a $K$-fold indexed type $Y$ of index $I$ and a $K$-fold indexed
      type $Z$ of index $J$, add $Z$ to $Y$.
      \begin{algorithmic}[1]
        \Require
          \Statex $Y$ is the indexed sum of some $x_0, ..., x_{n - 1} \in F$.
          \Statex $Z$ is the indexed sum of some $x_n, ..., x_{n + m - 1} \in F$.
          \Statex ${Y_k}_P, {Z_k}_P \in [1.5  \epsilon^{-1} 2^{a_{J + k}}, 1.75  \epsilon^{-1} 2^{a_{J + k}})$
        \Function{Reduce}{K, Y, Z}
          \State $I$ = \Call{IIndex}{Y}
          \State $J$ = \Call{IIndex}{Z}
          \If{$J < I$}
            \State $R = Z$
            \State \Call{Reduce}{K, $R$, $Y$}
            \State $Y = R$
            \State \Return
          \EndIf
          \State $k = J - I$
          \For{$k = J-I$ \To $K-1$}
            \State ${Y_{k}}_P = {Y_{k}}_P + ({Z_{k + I-J}}_P - 1.5 \epsilon^{-1}  2^{a_{I+k}})$
            \State ${Y_{k}}_C = {Y_{k}}_C + {Z_{k + I - J}}_C$
          \EndFor
          \State \Call{Renorm}{K, $Y$}
        \EndFunction
        \Ensure
          \Statex $Y$ is set to the indexed sum of $x_0, ..., x_{n + m - 1}$.
          \Statex ${Y_k}_P \in [1.5  \epsilon^{-1} 2^{a_{\min(I, J) + k}}, 1.75  \epsilon^{-1} 2^{a_{\min(I, J) + k}})$
      \end{algorithmic}
      \label{alg:reduce}
    \end{alg}
    \end{samepage}

    \begin{lem}
      If $n+m \leq 2^{2p-W-2}$ then the updating process in Algorithm~\ref{alg:reduce} is exact.
      \label{lem:reduce}
    \end{lem}
    \begin{proof}
      In order to prove the exactness of Algorithm~\ref{alg:reduce},
      it suffices to prove that the addition in line 12 is exact.
      Since $J$ is the index of $Z$, the index of ${Z_{k + I-J}}_P$ is
      $J + (k + I -J) = I + k$. It means that
      \(
        {Z_{k + I-J}}_P \in [1.5 \epsilon^{-1} 2^{a_{I+k}}, 1.75 \epsilon^{-1} 2^{a_{I+k}})
      \)
      and ${Z_{k + I-J}}_P \in 2^{a_{I+k}} \Z$.
      Therefore ${Z_{k + I-J}}_P - 1.5 \epsilon^{-1}  2^{a_{I+k}} \in 2^{a_{I+k}} \Z$
      and ${Z_{k + I-J}}_P - 1.5 \epsilon^{-1} \in [0, 0.25 \epsilon^{-1} 2^{a_{I+k}})$.
      This means ${Z_{k + I-J}}_P - 1.5 \epsilon^{-1}$ is representable and is
      exactly computed.
      Moreover, we have ${Y_{k}}_P \in 2^{a_{I+k}} \Z$ and
      \(
        {Y_{k}}_P \in [1.5 \epsilon^{-1} 2^{a_{I+k}}, 1.75 \epsilon^{-1} 2^{a_{I+k}})
      \).
      Therefore
      \(
        {Y_{k}}_P + ({Z_{k + I-J}}_P - 1.5 \epsilon^{-1}  2^{a_{I+k}})
          \in 2^{a_{I+k}} \Z,
      \)
      and
      \(
        {Y_{k}}_P + ({Z_{k + I-J}}_P - 1.5 \epsilon^{-1}  2^{a_{I+k}})
          \in [1.5 \epsilon^{-1} 2^{a_{I+k}}, 2 \epsilon^{-1} 2^{a_{I+k}})
      \).
      This means ${Y_{k}}_P + ({Z_{k + I-J}}_P - 1.5 \epsilon^{-1}  2^{a_{I+k}})$
      is representable and is exactly computed.
    \end{proof}

