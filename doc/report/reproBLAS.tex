\section{ReproBLAS}
  \label{sec:reproBLAS}
  ReproBLAS is the name given to our beloved library of implementations of algorithms described in this paper.
  It is available at \texttt{<http://bebop.cs.berkeley.edu/reproblas>}. 
  To be useful to the greatest amount of performance-conscious scientific software, ReproBLAS is written in C.
  The choice of C allows for intrepid Fortran and C++ users to take advantage of the library as well.
  Code generation and testing utilities are implemented in the more productive language Python.
  A few distributed memory functions are supplied using MPI, the industry standard for distributed memory programming.

  We leave the specifics of the library to the included documentation, and here offer only a summary of some of the design decisions made in ReproBLAS.

  Several of the functions in ReproBLAS are optionally vectorized using Intel AVX or SSE intrisics, depending on what is available on the system. With AVX, vectorization allows for 256-bit registers (4 \texttt{double} or 8 \texttt{float}) to be operated on in one instruction. Because so many routines were vectorized and due to the complicated nature of the operations, a Python suite was implemented to generate code that is generic to the particular vectorization in question. By simply augmenting this suite of code generation functions, this allows for future modifications of ReproBLAS to use newer intrinsics (such as AVX-512) when they become widely available. Another benefit of code generation is that it allows us to programatically restructure code to take advantage of loop unrolling and instruction-level paralellism. The build system handles the additional complexity of code generation with the help of the Python package Cog, which allows the programmer to write python code inline with C code.

  Code generation and cache blocking add several parameters to ReproBLAS that must be tuned. OpenTuner, an extensible Python autotuner, was used to search the parameter space to find optimal values for ReproBLAS parameters.

  ReproBLAS is divided into several modules, each one with a separate header file and static library. \texttt{idxd.h} contains the primitive operations discussed in Section \ref{sec:primitiveops} and the utility functions regarding the indexed type discussed in Section \ref{sec:indexed}. \texttt{idxd.h} also contains several basic functions not mentioned that relate to the core reproducible summation algorithm. \texttt{idxdBLAS.h} contains the indexed versions of the BLAS functions discussed in Section \ref{sec:compositeops}. These functions are optimized composite operations built from functions in \texttt{idxd.h}. \texttt{reproBLAS.h} contains versions of functions in \texttt{idxdBLAS.h} that do not require the user to use indexed types. Each function has the same function name as its BLAS counterpart, and functions similarly (except with added guarantees of reproducibility). Functions in \texttt{reproBLAS.h} with an ``r'' prepended to their name allow the user to specify the number of accumulators used to compute the result ($K$, where the internal indexed type used is $K$-fold). \texttt{idxdMPI.h} contains MPI datatypes used to communicate indexed types, and also contains an MPI reduction operator allowing the user to reproducibly reduce the MPI indexed types.
  \input{timing}
  \input{testing}
